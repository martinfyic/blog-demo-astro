---
import type { GetStaticPaths } from 'astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';
import BlogLayout from '@/layouts/BlogLayout.astro';

export const getStaticPaths = (async () => {
	const blogPosts = await getCollection('blog');

	return blogPosts.map(post => ({
		params: { slug: post.slug },
		props: { post: post },
	}));
}) satisfies GetStaticPaths;

const { post } = Astro.props;
const frontmatter = post.data;

const { Content, headings } = await post.render();
---

<BlogLayout
	title={frontmatter.title}
	description={frontmatter.description}
>
	<h1 class='mb-0 text-xs text-gray-500'>{frontmatter.title}</h1>
	<h4 class='text-md mb-0 text-gray-400'>{frontmatter.author}</h4>

	<Image
		class='my-6 h-[350px] w-full rounded-md object-cover'
		src={frontmatter.image}
		alt={frontmatter.title}
		width={600}
		height={220}
	/>

	<h3>Tabla de contenidos</h3>
	<ol>
		{
			headings.map((heading, index) => (
				<li>
					<a href={`#${heading.slug}`}>
						{index + 1} - {heading.text}
					</a>
				</li>
			))
		}
	</ol>

	<Content />

	<div class='my-20'>
		<a href='#btn-back'>Ir arriba</a>
	</div>
</BlogLayout>
